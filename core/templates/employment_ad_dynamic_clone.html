<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="utf-8">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;700&family=Rajdhani:wght@500;700&family=Lato:wght@400;700&display=swap" rel="stylesheet">
<title>Employment Advertisement - Dynamic Design (Clone)</title>
<style>
body {
  margin: 0;
  font-family: "Noto Sans Devanagari","Rajdhani","Lato","Arial",sans-serif;
  background: #f0f0f0;
  max-width: 100%;
  padding: 0;
}
  
  
  /* Top Header - Single row with centered title */
  .top-header {
    background: white;
    color: black;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0px 6px;
    font-weight: 900;
    font-size: 11pt;
    height: 0.6cm;
    max-height: 0.6cm;
    min-height: 0.6cm;
    box-sizing: border-box;
    margin-bottom: 0px;
    overflow: hidden;
  }
  
  .header-left {
    text-align: center;
    letter-spacing: 0.3px;
  }
  

  
  /* Meta Information Bar */
  .meta-bar {
    background: #fff;
    border-top: 0.5px solid #000;
    border-bottom: none;
    font-size: 5pt;
    box-sizing: border-box;
    height: 0.6cm;
    max-height: 0.6cm;
    min-height: 0.6cm;
    overflow: hidden;
  }
  
  .company-row {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0px 3px;
    font-size: 7pt;
    font-weight: 900;
    text-align: center;
    height: 0.3cm;
    min-height: 0.3cm;
    max-height: 0.3cm;
    border-bottom: none;
    word-wrap: break-word;
    overflow-wrap: break-word;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1; /* Take up available space */
  }
  
  .company-row.long-name {
    justify-content: flex-start;
    text-align: left;
  }
  
  .company-right-section {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding: 0px 3px;
    font-size: 4pt;
    font-weight: 600;
    text-align: right;
    height: 0.3cm;
    min-height: 0.3cm;
    max-height: 0.3cm;
    border-bottom: none;
    word-wrap: break-word;
    overflow-wrap: break-word;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    width: 2cm; /* Fixed width for right section */
  }
  
  .meta-items-row {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    gap: 0.1cm;
    height: 0.3cm;
    min-height: 0.3cm;
    max-height: 0.3cm;
    width: 100%;
    overflow: hidden;
  }
  
  /* Adjust grid when city is long - keep uniform gaps */
  .meta-items-row.long-city {
    grid-template-columns: 1fr 1fr 1fr 1.3fr;
    gap: 0.1cm;
  }
  
  .meta-item {
    padding: 0px 3px;
    text-align: left;
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }
  .meta-item-city {
    padding: 0px 3px;
    text-align: left;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    font-size: 5pt;
  }
  

  
  .meta-item b {
    font-weight: 700;
  }
  
  /* City field with smaller font 
  .meta-item:last-child {
    font-size: 4pt;
  }
  
  /* City field responsive behavior - even smaller when long */
  .meta-item:last-child.long-city {
    font-size: 3pt;
    justify-content: center;
    text-align: center;
  }
  
  /* Force city field to not be cropped */
  #city-item {
    min-width: 0;
    flex: 1;
    overflow: visible;
  }
  
  #city-item.long-city {
    justify-content: center !important;
    text-align: center !important;
    overflow: visible !important;
    white-space: normal !important;
  }
  
  /* Main Table */
  .main-table {
    width: 100%;
    border-collapse: collapse !important;
    border-spacing: 0 !important;
    table-layout: fixed;
    margin: 0;
    font-size: 4pt;
    line-height: 1;
    box-sizing: border-box;
    border-right: none;
  }
  
  /* Center the entire employment ad container */
.employment-ad {
  width: 612px;
  height: 792px;
  background: #fff;
  border: 1px solid #000;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  position: relative;
  box-sizing: border-box;
  overflow: hidden;
  font-size: 6pt;
}
  
  .main-table th,
  .main-table td {
    border: 0.25px solid #000;
    padding: 0px;
    text-align: center;
    vertical-align: middle;
    word-break: break-word;
    overflow: visible; /* Changed from hidden to visible */
    box-sizing: border-box;
  }
  
  .main-table thead tr:first-child th {
    border-top: 0.5px solid #000;
  }
  
  .main-table thead {
    height: 0.5cm;
    max-height: 0.5cm;
  }
  
  .main-table thead tr {
    height: 0.25cm;
    max-height: 0.25cm;
  }
  
  .main-table thead tr:first-child {
    height: 0.25cm;
    max-height: 0.25cm;
  }
  
  .main-table thead tr:last-child {
    height: 0.25cm;
    max-height: 0.25cm;
  }
  
  .main-table th:first-child,
  .main-table td:first-child {
    border-left: none;
  }
  
  .main-table th:last-child,
  .main-table td:last-child {
    border-right: none;
  }
  
  .main-table tbody tr:last-child td {
    border-bottom: none;
  }
  
  .main-table tbody {
    max-height: none !important;
    min-height: auto !important;
    height: auto !important;
    overflow: visible !important;
  }
  
  .main-table td {
    height: 0.4cm !important;
    min-height: 0.4cm !important;
    max-height: 0.4cm !important;
    overflow: hidden !important;
    line-height: 1.0 !important;
    padding: 0px !important;
    margin: 0px !important;
    border-spacing: 0px !important;
    font-size: 4pt !important;
  }
  
  .main-table th {
    background: #f8f8f8;
    font-weight: 700;
    font-size: 3pt;
    height: 0.25cm;
    min-height: 0.25cm;
    max-height: none; /* Allow height to grow if needed */
    box-sizing: border-box;
    padding: 0px;
    overflow: visible; /* Changed from hidden to visible */
    line-height: 1.0;
    vertical-align: middle;
  }
  

  
  .main-table th.col-position {
    font-weight: 900;
    font-size: 6pt;
  }
  
  .main-table th.col-salary {
    font-weight: 900;
    font-size: 4pt;
  }
  
  .main-table th[colspan="2"] {
    font-weight: 900;
    font-size: 4pt;
  }
  
  .main-table th.col-gender {
    font-weight: 900;
    font-size: 4pt;
  }
  
  .main-table .text-left {
    text-align: left;
  }
  
  .main-table .text-center {
    text-align: center !important;
    font-size: 3pt !important;
  }
  
  .main-table td.text-left {
    font-weight: 400 !important;
    font-size: 6pt !important;
    line-height: 1.1 !important;
    white-space: nowrap;
    text-overflow: ellipsis;
    padding-left: 2px !important;
  }
  
  .main-table .text-center {
    font-size: 3pt !important;
  }
  
  .main-table td:nth-child(3),
  .main-table td:nth-child(4),
  .main-table td:nth-child(12),
  .main-table td:nth-child(13) {
    font-weight: 700;
    font-size: 6pt;
  }
  
  /* Food and Housing columns - 12.5px font size */
  .col-food-house {
    font-size: 12.5px !important;
    font-weight: 900 !important;
  }
  
  /* Contract Duration column - 8pt font size */
  .col-contract-duration {
    font-size: 8pt !important;
    font-weight: 700 !important;
  }
  
  /* Extra section table - 3.74pt font size */
  .extra-table {
    font-size: 3.74pt !important;
  }
  
  .extra-table th,
  .extra-table td {
    font-size: 3.74pt !important;
    font-weight: 200 !important;
  }
  
  /* Insurance column - wider width */
  .extra-table .col-insurance {
    width: 14% !important;
    min-width: 14% !important;
    max-width: 14% !important;
  }
  
  /* Service fee column - 8% width */
  .extra-table .col-service-fee {
    width: 8% !important;
    min-width: 8% !important;
    max-width: 8% !important;
  }
  
  .main-table td:nth-child(5),
  .main-table td:nth-child(6) {
    font-weight: 700;
    font-size: 4pt; /* Reduced from 5pt to 4pt */
  }
  
  /* Column widths optimized for 12cm */
  .col-sn { width: 3%; }
  .col-position { width: 28%; } /* Reduced by 2% from 30% to 28% */
  .col-gender { width: 1%; } /* Reduced further from 2% to 1% */
  .col-salary { width: 12%; } /* Increased by 2% from 10% to 12% */
  .col-overtime { width: 5%; }
  .col-hours { width: 5%; }
  .col-days { width: 5%; }
  .col-leave { width: 5%; }
  .col-education { width: 7%; } /* Increased by 2% */
  .col-food { width: 5%; }
  .col-housing { width: 4%; }
  .col-contract { width: 7%; } /* Increased to 7% */
  
  /* Center text in yearly leave column */
  .main-table td.col-leave {
    text-align: center !important;
    font-size: 3pt !important;
  }
  
  /* Style overtime column */
  .main-table td.col-overtime {
    text-align: center !important;
    font-size: 3pt !important;
  }
  
  /* More specific rule to override any conflicting styles */
  .main-table tbody tr.data-row td.col-leave {
    text-align: center !important;
  }
  
  /* Remove bold from specific column headers */
  .main-table th.col-education,
  .main-table th.col-overtime,
  .main-table th.col-hours,
  .main-table th.col-days,
  .main-table th.col-leave,
  .main-table th.col-food,
  .main-table th.col-housing,
  .main-table th.col-contract {
    font-weight: normal;
    
    font-size: 3pt; /* Reduced by 1pt from default 3pt */
  }
  
  /* Ensure contract column text fits properly */
  .main-table th.col-contract,
.main-table td.col-contract {
  word-wrap: break-word;
  overflow-wrap: break-word;
  text-align: center;
  font-size: 2.5pt; /* Increased from 1.5pt to be readable */
  padding: 0px 1px; /* Add a tiny bit of padding to prevent text from touching the borders */
  max-width: 100%;
  white-space: normal; /* Change from nowrap to normal to allow wrapping */
  border-right: none; /* Remove right border */
}
  /* Data Row */
  .data-row {
    height: 0.4cm !important;
    min-height: 0.4cm !important;
    max-height: 0.4cm !important;
    margin: 0px !important;
    padding: 0px !important;
  }
  
  .data-row td {
    vertical-align: middle !important;
    font-size: 4pt !important;
    padding: 0px !important;
    margin: 0px !important;
    height: 0.4cm !important;
    min-height: 0.4cm !important;
    max-height: 0.4cm !important;
    overflow: hidden !important;
    line-height: 1.0 !important;
    border-spacing: 0px !important;
  }
  
  /* Interview Section */
  .interview-section {
    background: #000;
    color: #fff;
    padding: 0px;
    margin: 0px;
    margin-bottom: 0px; /* Ensure no bottom margin */
    border: none;
    font-size: 7pt;
    text-align: center;
    font-weight: 600;
    line-height: 1.2;
    min-height: 0.4cm;
    overflow: visible;
    display: flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
  }
  
  /* Extra Information Section */
  .extra-section {
    border-top: none;
    font-size: 2.5pt;
    margin-top: 0px; /* No top margin */
    margin-bottom: 0px; /* No bottom margin */
    padding-top: 0px;
    padding-bottom: 0px; /* No bottom padding */
    min-height: 0.65cm;
    max-height: none; /* Allow unlimited height for longer content */
    overflow: visible;
    box-sizing: border-box;
    width: 100%;
  }
  
  .extra-table {
    width: 100%;
    border-collapse: collapse;
  }
  
  .extra-table th,
  .extra-table td {
    border: 0.15px solid #000;
    padding: 0.25px 0.5px;
    text-align: center;
    vertical-align: middle;
    font-size: 3pt;
    line-height: 1;
    word-break: break-word;
    font-weight: 100 !important;
  }
  
  .extra-table th {
    background: #f8f8f8;
    font-weight: 100 !important;
    height: 0.35cm; /* Increased height */
  }
  
  .extra-table td {
    height: 0.3cm; /* Increased height */
  }
  
  .extra-table td:last-child {
    font-weight: 100 !important;
    font-size: 2.5pt;
  }
  
  .extra-table th:first-child,
  .extra-table td:first-child {
    border-left: none;
  }
  
  .extra-table th:last-child,
  .extra-table td:last-child {
    border-right: none;
  }
  
  .extra-note {
    padding: 0px !important;
    margin: 0px !important;
    font-size: 3.74pt !important;
    line-height: 1.0 !important;
    text-align: justify !important;
    text-justify: inter-word !important;
    border: none;
    background: #fff;
    min-height: 0.4cm; /* Minimum height for short content (Middle East notices) */
    max-height: none; /* Allow unlimited height for longer content (Japan notice) */
    overflow: visible; /* Changed from auto to visible */
    word-wrap: break-word;
    overflow-wrap: break-word;
    font-weight: 200;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    display: inline !important;
    /* Dynamic height based on content */
    height: auto;
  }
  
  /* Force left alignment for all extra-note content */
  .extra-note {
    text-align: left !important;
    text-justify: initial !important;
  }
  
  .extra-note * {
    text-align: left !important;
    text-justify: initial !important;
  }
  
  /* Japan content should not be justified - left aligned */
  .extra-note.japan-content {
    text-align: left !important;
    text-justify: initial !important;
  }
  
  /* Japan content bold headers should be on their own line */
  .extra-note.japan-content b {
    display: block !important;
    margin-bottom: 4px !important;
    font-weight: bold !important;
    text-align: left !important;
    text-justify: initial !important;
  }
  
  /* Japan content paragraphs should have proper spacing */
  .extra-note.japan-content p {
    margin-bottom: 8px !important;
    display: block !important;
    text-align: left !important;
    text-justify: initial !important;
    line-height: 1.4 !important;
  }
  
  /* Override body center alignment for Japan content */
  body .extra-note.japan-content {
    text-align: left !important;
  }
  
  body .extra-note.japan-content * {
    text-align: left !important;
  }
  
  /* Japan content paragraphs should be left aligned and maintain proper formatting */
  .extra-note.japan-content p,
  .extra-note.japan-content div,
  .extra-note.japan-content b,
  .extra-note.japan-content span {
    text-align: left !important;
    text-justify: initial !important;
    display: block !important;
    margin: 0 !important;
    padding: 0 !important;
    line-height: 1.2 !important;
  }
  
  /* Japan content bold headers should be on their own line */
  .extra-note.japan-content b {
    display: block !important;
    margin-bottom: 2px !important;
    font-weight: bold !important;
    text-align: left !important;
    text-justify: initial !important;
  }
  
  /* Japan content paragraphs should have proper spacing */
  .extra-note.japan-content p {
    margin-bottom: 4px !important;
    display: block !important;
    text-align: left !important;
    text-justify: initial !important;
  }
  
  /* Override any inline styles that might be applied */
  .extra-note.japan-content[style*="text-align: justify"] {
    text-align: left !important;
  }
  
  .extra-note.japan-content p[style*="text-align: justify"],
  .extra-note.japan-content b[style*="text-align: justify"] {
    text-align: left !important;
  }
  
  /* Override body center alignment with maximum specificity */
  body .extra-note.japan-content,
  body .extra-note.japan-content *,
  body .extra-note.japan-content p,
  body .extra-note.japan-content b,
  body .extra-note.japan-content div,
  body .extra-note.japan-content span {
    text-align: left !important;
    text-justify: initial !important;
  }
  
  /* Maximum specificity override for body center alignment */
  body div.extra-note,
  body div.extra-note *,
  body div.extra-note p,
  body div.extra-note b,
  body div.extra-note div,
  body div.extra-note span {
    text-align: left !important;
    text-justify: initial !important;
  }
  
  /* Nuclear option - override everything in extra-note */
  .extra-note,
  .extra-note *,
  .extra-note p,
  .extra-note div,
  .extra-note span,
  .extra-note br,
  .extra-note strong,
  .extra-note em,
  .extra-note i,
  .extra-note u {
    text-align: left !important;
    text-justify: initial !important;
  }
  
  /* Preserve bold formatting */
  .extra-note b,
  .extra-note strong {
    font-weight: bold !important;
    display: block !important;
    margin-bottom: 4px !important;
    text-align: left !important;
  }
  
  /* Force left alignment on bold elements with maximum specificity */
  body .extra-note b,
  body .extra-note strong,
  body div.extra-note b,
  body div.extra-note strong {
    text-align: left !important;
    text-justify: initial !important;
  }
  
  /* Override any center alignment on bold elements */
  .extra-note b[style*="center"],
  .extra-note strong[style*="center"],
  .extra-note b[style*="justify"],
  .extra-note strong[style*="justify"] {
    text-align: left !important;
  }
  
  /* Force left alignment on all extra-note content */
  .extra-note * {
    text-align: left !important;
  }
  
  /* Preserve paragraph formatting */
  .extra-note p {
    display: block !important;
    margin-bottom: 8px !important;
    text-align: left !important;
    line-height: 1.4 !important;
    font-weight: normal !important;
  }
  
  /* Ensure bold elements in paragraphs are properly formatted */
  .extra-note p b {
    font-weight: bold !important;
    display: inline !important;
    margin-bottom: 0 !important;
  }
  
  /* Force numbered items to be on separate lines */
  .extra-note:not(:empty) {
    text-align: left !important;
  }
  
  .extra-note:not(:empty) * {
    text-align: left !important;
    display: block !important;
  }
  
  
  /* Universal left alignment for all extra-note content */
  .extra-note {
    text-align: left !important;
  }
  
  .extra-note * {
    text-align: left !important;
  }
  
  /* Override any justify alignment */
  .extra-note[style*="justify"],
  .extra-note *[style*="justify"] {
    text-align: left !important;
  }
  
  
  /* Production-ready: Prevent layout shifts and ensure stable rendering */
  * {
    box-sizing: border-box;
  }
  
  .employment-ad * {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000;
    perspective: 1000;
  }
  
  /* Prevent any visual changes during load */
  .employment-ad {
    visibility: hidden;
    opacity: 0;
    transition: none;
  }
  
  .employment-ad.loaded {
    visibility: visible;
    opacity: 1;
  }
  
  
  .extra-note h4 {
    margin: 0;
    font-size: 3.5pt;
    font-weight: 200 !important;
    color:black;
  }
  
  /* When city is long, we'll add .is-long-city via JS */
  .meta-items-row.is-long-city { grid-template-columns: 1fr 1fr 1fr 1.3fr; }
  
  /* When extra note is Japan-format, we'll add .is-japan */
  .extra-note.is-japan, .extra-note.is-japan * { text-align: left !important; text-justify: initial !important; }
  
  /* Center the note section */
  .extra-note b:last-child {
    text-align: left !important;
    display: inline !important;
    width: auto !important;
    padding: 0px !important;
    margin: 0px !important;
  }
  
  /* Print-specific styles */
  @media print {
    * {
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
      color-adjust: exact !important;
    }
    
    .employment-ad { 
      box-shadow: none; 
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    
    .company-banner {
      position: absolute;
      left: 0; right: 0; bottom: 0;
      width: 100%;
    }
    
    .main-table th,
    .main-table td {
      border: 0.25px solid #000;
    }
  }
  
        .notice-content {
        font-size: 3.74pt !important;
        line-height: 1.0 !important;
        color:#000;
        margin: 0 !important;
        padding: 0 !important;
        width: 100% !important;
        max-width: 100% !important;
        box-sizing: border-box !important;
        font-weight: 200;
        text-align: left !important;
        display: block !important;
        display: block !important;
      }
      
      .notice-paragraph {
        margin: 0 !important;
        padding: 0 !important;
        text-align: left !important;
        width: 100% !important;
        max-width: 100% !important;
        box-sizing: border-box !important;
        font-size: 3.74pt !important;
        line-height: 1.0 !important;
        page-break-inside: avoid;
      }
      
      .notice-paragraph:last-child {
        margin-bottom: 0;
  }
  
  /* Main content wrapper */
  .main-content {
    flex: 1;
    overflow: visible;
    padding: 18px 20px 60px; /* top, sides, bottom; bottom reserved for banner */
    box-sizing: border-box;
  }
  
  /* Company Banner - Pinned to bottom */
  .company-banner {
    position: absolute;
    left: 0; right: 0; bottom: 0;
    width: 100%;
    height: 1.2cm;
    min-height: 1.2cm;
    max-height: 1.2cm;
    background: #fff;
    border-top: 0.5px solid #000;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 8px;
    box-sizing: border-box;
    overflow: hidden;
  }
  
  .company-logo {
    background: #fff;
    color: #000;
    height: 0.3cm !important;
    max-height: 0.3cm !important;
    width: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 900;
    font-size: 2pt;
    border: 1px solid #fff;
    overflow: hidden;
    margin: 0px;
    padding: 0px;
  }
  
  .company-info {
    text-align: center;
    height: 0.3cm !important;
    max-height: 0.3cm !important;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    margin: 0px;
    padding: 0px;
  }
  
  .company-info h1 {
    margin: 0 0 0px 0;
    font-size: 4pt;
    font-weight: 900;
    letter-spacing: 0.1px;
  }
  
  .company-info p {
    margin: 0;
    font-size: 2pt;
    line-height: 1;
  }
  
  .license-box {
    background: white;
    border: black;
    text-align: center;
    padding: 0px;
    font-size: 2pt;
    font-weight: 700;
    line-height: 1;
    height: 0.3cm !important;
    max-height: 0.3cm !important;
    width: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    margin: 0px;
  }
  
  @media print {
    body { 
      margin: 0; 
      padding: 0; 
      background: #fff; 
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    .employment-ad { 
      box-shadow: none; 
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }
    /* Ensure stable print rendering */
    * {
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
  }
</style>
</head>
<body>

<div class="employment-ad">
  <div class="main-content">
    <!-- Top Header - Centered title only -->
  <div class="top-header">
    <div class="header-left">{% if ad.country and ad.country.strip %}{{ ad.country }} {% else %}देश {% endif %}मा रोजगारी</div>
  </div>
  
  <!-- Meta Information -->
  <div class="meta-bar">
    <div style="display: flex; align-items: center; height: 0.3cm;">
      <div class="company-row" id="company-row">कम्पनी: {% if ad.company_name %}{{ ad.company_name }}{% else %}कुनै कम्पनी{% endif %}</div>
      {% if ad.right_section_text %}
      <div class="company-right-section">{{ ad.right_section_text }}</div>
      {% endif %}
    </div>
    <div class="meta-items-row" id="meta-items-row">
    <div class="meta-item">Pre Approval Date: <b>{% if ad.pre_approval_date %}{{ ad.pre_approval_date }}{% else %}कुनै मिति{% endif %}</b></div>
    <div class="meta-item">Chalani No.: <b>{% if ad.chalani_no %}{{ ad.chalani_no }}{% else %}कुनै नम्बर{% endif %}</b></div>
    <div class="meta-item">LOT No.: <b>{% if ad.lot_no %}{{ ad.lot_no }}{% else %}कुनै नम्बर{% endif %}</b></div>

      <div class="meta-item-city">City: <b>{% if ad.city %}{{ ad.city }}{% else %}कुनै शहर{% endif %}</b></div>
    </div>
  </div>
  
  <!-- Main Table -->
  <table class="main-table">
    <!-- Header Row 1 -->
    <thead>
      <tr>
        <th rowspan="2" class="col-sn">सि.नं.</th>
        <th rowspan="2" class="col-position">कामदारको पद</th>
        <th colspan="2">माग संख्या</th>
        <th colspan="2">मासिक तलब</th>
        <th rowspan="2" class="col-education">कामदारका न्युनतम योग्यता</th>
        <th rowspan="2" class="col-overtime">ओभर<br>टाइम<br>सुविधा</th>
        <th rowspan="2" class="col-hours">प्रतिदिन काम<br>गर्ने घण्टा</th>
        <th rowspan="2" class="col-days">हप्तामा काम<br>गर्ने दिन</th>
        <th rowspan="2" class="col-leave">वार्षिक<br>विदा</th>
        <th rowspan="2" class="col-food">खाने सुविधा</th>
        <th rowspan="2" class="col-housing">बस्ने<br>सुविधा</th>
        <th rowspan="2" class="col-contract">करार<br>अवधि</th>
      </tr>
      <tr>
        <th class="col-gender">पुरुष</th>
        <th class="col-gender">महिला</th>
        <th class="col-salary">{{ positions.0.salary_currency|default:"KD" }}</th>
        <th class="col-salary">ने.रु.</th>
      </tr>
    </thead>
        <!-- Data Rows - Dynamic from database -->
    <tbody>
      {% for position in positions %}
      <tr class="data-row">
        <td>{{ forloop.counter }}</td>
        <td class="text-left">{{ position.position }}</td>
        <td>{{ position.male_count }}</td>
        <td>{{ position.female_count }}</td>
        <td>{{ position.salary_amount }}</td>
        <td>{{ position.salary_npr|safe }}</td>
        {% if forloop.first %}
        <!-- Common fields - only show in first row and span across all positions -->
        <td class="text-center" rowspan="{{ positions|length }}">{{ positions.0.min_qualification|safe|linebreaksbr }}</td>
        <td class="col-overtime" rowspan="{{ positions|length }}">{{ positions.0.overtime }}</td>
        <td rowspan="{{ positions|length }}">{{ positions.0.hours_per_day|safe|linebreaksbr }}</td>
        <td rowspan="{{ positions|length }}">{{ positions.0.days_per_week|safe|linebreaksbr }}</td>
        <td class="col-leave" style="text-align: center !important;" rowspan="{{ positions|length }}">{{ positions.0.yearly_leave }}</td>
        <td class="col-food-house" rowspan="{{ positions|length }}">{{ positions.0.food_provided }}</td>
        <td class="col-food-house" rowspan="{{ positions|length }}">{{ positions.0.housing_provided }}</td>
        <td class="col-contract-duration" rowspan="{{ positions|length }}">{% if positions.0.contract_duration %}{{ positions.0.contract_duration|slice:":2" }}<br>वर्ष{% endif %}</td>
        {% endif %}
        </tr>
      {% empty %}
      <!-- No positions exist - show empty table -->
      <tr class="data-row">
        <td colspan="13" style="text-align: center; color: #999;">कुनै पदहरू फेला परेनन्</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  
  <!-- Interview Section -->
  <div class="interview-section">
    {% if ad.interview_custom_text %}
      <!-- Manual interview text from user -->
      {{ ad.interview_custom_text }}
    {% elif ad.interview_nepali_date and ad.interview_gregorian_date and ad.interview_location %}
      <!-- Manual interview details from EmploymentAd model -->
      अन्तरवार्ता मिति {{ ad.interview_nepali_date }} गते ({{ ad.interview_gregorian_date }}) {{ ad.interview_location }} हुनेछ ।
    {% elif ad.pre_approval_date %}
      <!-- Automatic interview date calculation -->
        <span id="interview-date-text">
          अन्तरवार्ता मिति <span id="calculated-interview-date">गणना गर्दै...</span> गते (<span id="calculated-interview-date-english">गणना गर्दै...</span>) म्यानपावरको कार्यालयमा हुनेछ ।
        </span>
        <script>
          // Calculate interview date automatically (8 days after approval date)
          function calculateInterviewDate() {
            const preApprovalDate = '{{ ad.pre_approval_date }}';
            if (preApprovalDate && preApprovalDate !== 'None' && preApprovalDate !== '') {
              try {
                // Parse the approval date (handle both YYYY-MM-DD and YYYY/MM/DD formats)
                let approvalDate;
                if (preApprovalDate.includes('/')) {
                  // Handle Nepali date format (YYYY/MM/DD)
                  const parts = preApprovalDate.split('/');
                  if (parts.length === 3) {
                    const year = parseInt(parts[0]);
                    const month = parseInt(parts[1]) - 1; // Month is 0-indexed
                    const day = parseInt(parts[2]);
                    approvalDate = new Date(year, month, day);
                  }
                } else if (preApprovalDate.includes('-')) {
                  // Handle Gregorian date format (YYYY-MM-DD)
                  approvalDate = new Date(preApprovalDate);
                }
                
                if (approvalDate && !isNaN(approvalDate.getTime())) {
                  // Calculate interview date (8 days after approval)
                  const interviewDate = new Date(approvalDate);
                  interviewDate.setDate(approvalDate.getDate() + 8);
                  
                  // Format Nepali date (YYYY/MM/DD)
                  const nepaliDate = `${interviewDate.getFullYear()}/${String(interviewDate.getMonth() + 1).padStart(2, '0')}/${String(interviewDate.getDate()).padStart(2, '0')}`;
                  
                  // Format Gregorian date (DD Month, YYYY)
                  const gregorianDate = interviewDate.toLocaleDateString('en-US', { 
                    day: 'numeric', 
                    month: 'long', 
                    year: 'numeric' 
                  });
                  
                  // Update the display
                  document.getElementById('calculated-interview-date').textContent = nepaliDate;
                  document.getElementById('calculated-interview-date-english').textContent = gregorianDate;
                  
                  console.log('✅ Interview date automatically calculated:', nepaliDate, '(', gregorianDate, ')');
                }
              } catch (error) {
                console.error('Error calculating interview date:', error);
                document.getElementById('calculated-interview-date').textContent = 'गणना गर्न सकिएन';
                document.getElementById('calculated-interview-date-english').textContent = 'Calculation failed';
              }
            } else {
              document.getElementById('calculated-interview-date').textContent = 'पूर्व स्वीकृति मिति आवश्यक';
              document.getElementById('calculated-interview-date-english').textContent = 'Pre-approval date required';
            }
          }
          
          
          // Handle company name alignment
          function adjustCompanyNameAlignment() {
            const companyRow = document.getElementById('company-row');
            if (companyRow) {
              // Check if the text content is too long (more than 30 characters)
              const companyText = companyRow.textContent;
              if (companyText.length > 30) {
                companyRow.classList.add('long-name');
              } else {
                companyRow.classList.remove('long-name');
              }
            }
          }
          
          
          // Handle city field alignment
          function adjustCityAlignment() {
            const cityItem = document.getElementById('city-item');
            const row = document.getElementById('meta-items-row');
            if (!cityItem || !row) return;
            const txt = cityItem.textContent.trim();
            if (txt.length > 12) {
              row.classList.add('is-long-city');
              cityItem.style.fontSize = '3pt';
            } else {
              row.classList.remove('is-long-city');
              cityItem.style.fontSize = '4pt';
            }
          }
          
          
          function handleJapanContent() {
            const extraNote = document.querySelector('.extra-note');
            if (!extraNote) return;
            const looksLikeJapan = /जापान|प्रशिक्षार्थी|N4|वैदेशिक रोजगार विभाग/.test(extraNote.textContent);
            if (looksLikeJapan) extraNote.classList.add('is-japan');
          }
          
          
          // Ensure each data row is strictly 0.4cm
          function adjustTbodyHeight() {
            const tbody = document.querySelector('.main-table tbody');
            if (tbody) {
              const dataRows = tbody.querySelectorAll('.data-row');
              
              // Allow tbody to grow naturally
              tbody.style.setProperty('height', 'auto', 'important');
              tbody.style.setProperty('min-height', 'auto', 'important');
              tbody.style.setProperty('max-height', 'none', 'important');
              
              // Set each row to strictly 0.4cm with no padding/margin
              dataRows.forEach(row => {
                row.style.setProperty('height', '0.4cm', 'important');
                row.style.setProperty('min-height', '0.4cm', 'important');
                row.style.setProperty('max-height', '0.4cm', 'important');
                row.style.setProperty('margin', '0px', 'important');
                row.style.setProperty('padding', '0px', 'important');
                
                // Set each cell in the row to 0.4cm with no padding/margin
                const cells = row.querySelectorAll('td');
                cells.forEach(cell => {
                  cell.style.setProperty('height', '0.4cm', 'important');
                  cell.style.setProperty('min-height', '0.4cm', 'important');
                  cell.style.setProperty('max-height', '0.4cm', 'important');
                  cell.style.setProperty('overflow', 'hidden', 'important');
                  cell.style.setProperty('line-height', '1.0', 'important');
                  cell.style.setProperty('padding', '0px', 'important');
                  cell.style.setProperty('margin', '0px', 'important');
                  cell.style.setProperty('border-spacing', '0px', 'important');
                  
                  // Don't override font-size for position field (text-left class) or min_qualification field (text-center class)
                  if (!cell.classList.contains('text-left') && !cell.classList.contains('text-center')) {
                    cell.style.setProperty('font-size', '4pt', 'important');
                  }
                  
                  // Ensure position field has correct font size and styling
                  if (cell.classList.contains('text-left')) {
                    cell.style.setProperty('font-size', '7pt', 'important');
                    cell.style.setProperty('font-weight', '400', 'important');
                    cell.style.setProperty('padding-left', '2px', 'important');
                  }
                  
                  // Ensure yearly leave column is centered
                  if (cell.classList.contains('col-leave')) {
                    cell.style.textAlign = 'center';
                    cell.setAttribute('style', cell.getAttribute('style') + '; text-align: center !important;');
                    cell.style.setProperty('font-size', '3pt', 'important');
                  }
                  
                  // Ensure overtime column is centered and has correct font size
                  if (cell.classList.contains('col-overtime')) {
                    cell.style.setProperty('text-align', 'center', 'important');
                    cell.style.setProperty('font-size', '3pt', 'important');
                  }
                  
                  // Ensure min_qualification field has correct font size and alignment
                  if (cell.classList.contains('text-center')) {
                    cell.style.setProperty('font-size', '3pt', 'important');
                    cell.style.setProperty('text-align', 'center', 'important');
                  }
                });
              });
            }
          }
          
          // Single initialization - no timeouts to prevent flickering
          document.addEventListener('DOMContentLoaded', function() {
            adjustTbodyHeight();
            handleJapanContent();
            adjustCityAlignment();
            adjustCompanyNameAlignment?.();
            calculateInterviewDate?.();
            forceLightFontWeights?.();
            document.querySelector('.employment-ad')?.classList.add('loaded');
          });
          
          // Production-ready font weight handler - prevents flickering
          let fontsProcessed = false;
          
          function forceLightFontWeights() {
            // Prevent multiple executions to avoid flickering
            if (fontsProcessed) {
              return;
            }
            
            // Force apply light font weights
            const extraTableCells = document.querySelectorAll('.extra-table th, .extra-table td');
            extraTableCells.forEach(function(cell) {
              if (!cell.dataset.fontProcessed) {
                cell.style.setProperty('font-weight', '100', 'important');
                cell.dataset.fontProcessed = 'true';
              }
            });
            
            const extraNoteElements = document.querySelectorAll('.extra-note, .extra-note h4, .notice-content');
            extraNoteElements.forEach(function(element) {
              // Skip Japan content - it has its own formatting
              if (element.classList.contains('japan-content')) {
                return;
              }
              
              if (!element.dataset.fontProcessed) {
                element.style.setProperty('font-weight', '200', 'important');
                element.style.setProperty('font-size', '3.76pt', 'important');
                element.style.setProperty('line-height', '1.4', 'important');
                // Don't apply justify to Japan content - let CSS handle it
                if (!element.closest('.japan-content')) {
                  element.style.setProperty('text-align', 'justify', 'important');
                  element.style.setProperty('text-justify', 'inter-word', 'important');
                }
                element.style.setProperty('margin', '0px', 'important');
                element.style.setProperty('padding', '0px', 'important');
                element.dataset.fontProcessed = 'true';
              }
            });
            
            // Handle Japan content formatting in print mode
            const japanContent = document.querySelector('.extra-note.japan-content');
            if (japanContent) {
              // Apply left alignment to the main container
              japanContent.style.setProperty('text-align', 'left', 'important');
              japanContent.style.setProperty('text-justify', 'initial', 'important');
              
              // Handle bold elements
              const boldElements = japanContent.querySelectorAll('b');
              boldElements.forEach(function(bold) {
                bold.style.setProperty('display', 'block', 'important');
                bold.style.setProperty('margin-bottom', '2px', 'important');
                bold.style.setProperty('font-weight', 'bold', 'important');
                bold.style.setProperty('text-align', 'left', 'important');
                bold.style.setProperty('text-justify', 'initial', 'important');
              });
              
              // Handle paragraphs
              const paragraphs = japanContent.querySelectorAll('p');
              paragraphs.forEach(function(p) {
                p.style.setProperty('display', 'block', 'important');
                p.style.setProperty('margin-bottom', '4px', 'important');
                p.style.setProperty('text-align', 'left', 'important');
                p.style.setProperty('text-justify', 'initial', 'important');
                p.style.setProperty('line-height', '1.2', 'important');
                p.style.setProperty('font-size', '3.76pt', 'important');
              });
            }
            
            // Also target all paragraphs within notice content
            const noticeParagraphs = document.querySelectorAll('.notice-content p, .notice-content div, .extra-note p, .extra-note div');
            noticeParagraphs.forEach(function(element) {
              // Check if this is Japan content
              const extraNote = element.closest('.extra-note');
              if (extraNote && extraNote.classList.contains('japan-content')) {
                element.style.setProperty('text-align', 'left', 'important');
                element.style.setProperty('text-justify', 'initial', 'important');
              } else {
                element.style.setProperty('text-align', 'justify', 'important');
                element.style.setProperty('text-justify', 'inter-word', 'important');
              }
              element.style.setProperty('font-size', '3.76pt', 'important');
              element.style.setProperty('line-height', '1.4', 'important');
              element.style.setProperty('width', 'auto', 'important');
              element.style.setProperty('max-width', '100%', 'important');
              element.style.setProperty('margin', '0px', 'important');
              element.style.setProperty('padding', '0px', 'important');
              element.style.setProperty('display', 'inline', 'important');
            });
            
            // Left align the note section (last bold element)
            const noteElement = document.querySelector('.extra-note b:last-child');
            if (noteElement) {
              noteElement.style.setProperty('text-align', 'left', 'important');
              noteElement.style.setProperty('display', 'inline', 'important');
              noteElement.style.setProperty('width', 'auto', 'important');
              noteElement.style.setProperty('padding', '0px', 'important');
              noteElement.style.setProperty('margin', '0px', 'important');
            }
            
            const mainTableCells = document.querySelectorAll('.main-table td.text-left');
            mainTableCells.forEach(function(cell) {
              cell.style.setProperty('font-weight', '400', 'important');
              cell.style.fontWeight = '400';
              cell.setAttribute('style', cell.getAttribute('style') + '; font-weight: 400 !important;');
            });
            
            const centerCells = document.querySelectorAll('.main-table .text-center, .main-table td.col-leave, .main-table td.col-overtime');
            centerCells.forEach(function(cell) {
              cell.style.setProperty('font-weight', '200', 'important');
              cell.style.fontWeight = '200';
              cell.setAttribute('style', cell.getAttribute('style') + '; font-weight: 200 !important;');
            });
            
            // Only increase header elements
            const headerLeft = document.querySelectorAll('.header-left');
            headerLeft.forEach(function(element) {
              element.style.setProperty('font-size', '13pt', 'important');
              element.style.setProperty('font-weight', '700', 'important');
            });
            
            const headerRight = document.querySelectorAll('.header-right');
            headerRight.forEach(function(element) {
              element.style.setProperty('font-size', '7pt', 'important');
              element.style.setProperty('font-weight', '600', 'important');
            });
            
            // Company row
            const companyRow = document.querySelectorAll('.company-row');
            companyRow.forEach(function(element) {
              element.style.setProperty('font-size', '7pt', 'important');
              element.style.setProperty('font-weight', '600', 'important');
              element.style.setProperty('height', '0.3cm', 'important');
              element.style.setProperty('max-height', '0.3cm', 'important');
              element.style.setProperty('min-height', '0.3cm', 'important');
              element.style.setProperty('display', 'flex', 'important');
              element.style.setProperty('align-items', 'center', 'important');
              element.style.setProperty('justify-content', 'center', 'important');
              element.style.setProperty('overflow', 'hidden', 'important');
              element.style.setProperty('text-overflow', 'ellipsis', 'important');
              element.style.setProperty('white-space', 'nowrap', 'important');
            });
            
            // Meta bar
            const metaBar = document.querySelectorAll('.meta-bar');
            metaBar.forEach(function(element) {
              element.style.setProperty('font-size', '5pt', 'important');
              element.style.setProperty('font-weight', '500', 'important');
              element.style.setProperty('height', '0.6cm', 'important');
              element.style.setProperty('max-height', '0.6cm', 'important');
              element.style.setProperty('min-height', '0.6cm', 'important');
              element.style.setProperty('overflow', 'hidden', 'important');
              element.style.setProperty('display', 'flex', 'important');
              element.style.setProperty('flex-direction', 'column', 'important');
            });
            
            // Meta items row
            const metaItemsRow = document.querySelectorAll('.meta-items-row');
            metaItemsRow.forEach(function(element) {
              element.style.setProperty('font-size', '5pt', 'important');
              element.style.setProperty('font-weight', '500', 'important');
              element.style.setProperty('height', '0.3cm', 'important');
              element.style.setProperty('max-height', '0.3cm', 'important');
              element.style.setProperty('min-height', '0.3cm', 'important');
              element.style.setProperty('display', 'grid', 'important');
              
              // Adjust grid columns based on long-city class
              if (element.classList.contains('long-city')) {
                element.style.setProperty('grid-template-columns', '1fr 1fr 1fr 1.3fr', 'important');
                element.style.setProperty('gap', '0.1cm', 'important');
              } else {
                element.style.setProperty('grid-template-columns', '1fr 1fr 1fr 1fr', 'important');
                element.style.setProperty('gap', '0.1cm', 'important');
              }
              
              element.style.setProperty('overflow', 'hidden', 'important');
            });
            
            // Meta items
            const metaItems = document.querySelectorAll('.meta-item');
            metaItems.forEach(function(element) {
              element.style.setProperty('font-size', '5pt', 'important');
              element.style.setProperty('font-weight', '500', 'important');
              element.style.setProperty('padding', '0px 3px', 'important');
              element.style.setProperty('text-align', 'left', 'important');
              element.style.setProperty('display', 'flex', 'important');
              element.style.setProperty('align-items', 'center', 'important');
              element.style.setProperty('justify-content', 'flex-start', 'important');
              element.style.setProperty('overflow', 'hidden', 'important');
              element.style.setProperty('text-overflow', 'ellipsis', 'important');
              element.style.setProperty('white-space', 'nowrap', 'important');
              
              // Handle long city names specifically
              if (element.id === 'city-item' && element.classList.contains('long-city')) {
                element.style.setProperty('justify-content', 'center', 'important');
                element.style.setProperty('text-align', 'center', 'important');
              }
            });
            
            // City field (last child) with smaller font for print
            const cityItems = document.querySelectorAll('.meta-item:last-child');
            cityItems.forEach(function(element) {
              if (element.classList.contains('long-city')) {
                element.style.setProperty('font-size', '3pt', 'important');
              } else {
                element.style.setProperty('font-size', '4pt', 'important');
              }
            });
            
            // Meta item data (values) at 6pt
            const metaItemData = document.querySelectorAll('.meta-item b');
            metaItemData.forEach(function(element) {
              element.style.setProperty('font-size', '6pt', 'important');
              element.style.setProperty('font-weight', '600', 'important');
            });
            
            // Only position header - "कामदारको पद"
            const positionHeaders = document.querySelectorAll('.main-table th.col-position');
            positionHeaders.forEach(function(element) {
              element.style.setProperty('font-size', '7pt', 'important');
              element.style.setProperty('font-weight', '700', 'important');
            });
            
            // Colspan 2 headers - increased font size
            const colspan2Headers = document.querySelectorAll('.main-table th[colspan="2"]');
            colspan2Headers.forEach(function(element) {
              element.style.setProperty('font-size', '4.6pt', 'important');
              element.style.setProperty('font-weight', '520', 'important');
            });
            
            // Second row headers - increased font size
            const secondRowHeaders = document.querySelectorAll('.main-table th.col-gender, .main-table th.col-salary');
            secondRowHeaders.forEach(function(element) {
              element.style.setProperty('font-size', '5.3pt', 'important');
              element.style.setProperty('font-weight', '550', 'important');
            });
            
            // Specific data cells - increased font size
            const specificDataCells = document.querySelectorAll('.main-table td:nth-child(3), .main-table td:nth-child(4), .main-table td:nth-child(5), .main-table td:nth-child(6)');
            specificDataCells.forEach(function(element) {
              element.style.setProperty('font-size', '6pt', 'important');
              element.style.setProperty('font-weight', '550', 'important');
            });
            
            // Food and Housing columns - 12.5px font size
            const foodHousingCells = document.querySelectorAll('.col-food-house');
            foodHousingCells.forEach(function(element) {
              element.style.setProperty('font-size', '12.5px', 'important');
              element.style.setProperty('font-weight', '900', 'important');
            });
            
            // Contract Duration column - 8pt font size
            const contractDurationCells = document.querySelectorAll('.col-contract-duration');
            contractDurationCells.forEach(function(element) {
              element.style.setProperty('font-size', '8pt', 'important');
              element.style.setProperty('font-weight', '700', 'important');
            });
            
            // Extra section table - 3.74pt font size
            const extraTableElements = document.querySelectorAll('.extra-table, .extra-table th, .extra-table td');
            extraTableElements.forEach(function(element) {
              element.style.setProperty('font-size', '3.74pt', 'important');
              element.style.setProperty('font-weight', '200', 'important');
            });
            
            // Mark as processed to prevent re-execution
            fontsProcessed = true;
          }
          
          // Production-ready event listeners - no flickering
          window.addEventListener('beforeprint', forceLightFontWeights);
          window.addEventListener('print', forceLightFontWeights);
          
          
          // Nepali calendar conversion function
          function gregorianToNepali(gregorianDate) {
            // Base date: 1943-04-14 (Gregorian) = 2000-01-01 (Nepali)
            const baseDate = new Date(1943, 3, 14); // Month is 0-indexed
            const baseNepaliYear = 2000;
            const baseNepaliMonth = 1;
            const baseNepaliDay = 1;
            
            // Calculate days difference
            const timeDiff = gregorianDate.getTime() - baseDate.getTime();
            const daysDiff = Math.floor(timeDiff / (1000 * 3600 * 24));
            
            // Nepali calendar data (days in each month for years 2000-2090)
            const nepaliCalendar = {
              2000: [30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 30],
              2001: [31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 29, 31],
              2002: [31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 29, 31],
              2003: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2004: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2005: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2006: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2007: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2008: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2009: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2010: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2011: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2012: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2013: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2014: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2015: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2016: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2017: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2018: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2019: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2020: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2021: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2022: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2023: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2024: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2025: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2026: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2027: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2028: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2029: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2030: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2031: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2032: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2033: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2034: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2035: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2036: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2037: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2038: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2039: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2040: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2041: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2042: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2043: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2044: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2045: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2046: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2047: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2048: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2049: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2050: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2051: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2052: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2053: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2054: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2055: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2056: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2057: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2058: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2059: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2060: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2061: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2062: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2063: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2064: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2065: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2066: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2067: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2068: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2069: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2070: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2071: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2072: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2073: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2074: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2075: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2076: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2077: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2078: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2079: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2080: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2081: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2082: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2083: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2084: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2085: [31, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2086: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2087: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
              2088: [30, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 30],
              2089: [31, 31, 32, 32, 31, 31, 30, 30, 29, 30, 29, 31],
              2090: [30, 31, 32, 32, 31, 30, 30, 30, 29, 30, 29, 30]
            };
            
            // Convert days to Nepali date
            let remainingDays = daysDiff;
            let nepaliYear = baseNepaliYear;
            let nepaliMonth = baseNepaliMonth;
            let nepaliDay = baseNepaliDay;
            
            // Find the year
            while (remainingDays > 0 && nepaliYear <= 2090) {
              const yearDays = nepaliCalendar[nepaliYear].reduce((sum, days) => sum + days, 0);
              if (remainingDays >= yearDays) {
                remainingDays -= yearDays;
                nepaliYear++;
              } else {
                break;
              }
            }
            
            // Find the month
            while (remainingDays > 0 && nepaliMonth <= 12) {
              const monthDays = nepaliCalendar[nepaliYear][nepaliMonth - 1];
              if (remainingDays >= monthDays) {
                remainingDays -= monthDays;
                nepaliMonth++;
              } else {
                break;
              }
            }
            
            // Calculate the day
            nepaliDay = remainingDays + 1;
            
            // Convert to Nepali numerals
            const nepaliNumerals = ['०', '१', '२', '३', '४', '५', '६', '७', '८', '९'];
            const nepaliMonths = ['', 'बैशाख', 'जेठ', 'असार', 'श्रावण', 'भदौ', 'असोज', 'कार्तिक', 'मंसिर', 'पुष', 'माघ', 'फाल्गुन', 'चैत'];
            
            function toNepaliNumeral(num) {
              return num.toString().split('').map(digit => nepaliNumerals[parseInt(digit)]).join('');
            }
            
            return {
              year: toNepaliNumeral(nepaliYear),
              month: toNepaliNumeral(nepaliMonth.toString().padStart(2, '0')),
              day: toNepaliNumeral(nepaliDay.toString().padStart(2, '0')),
              monthName: nepaliMonths[nepaliMonth]
            };
          }
          
          // Calculate interview date (8 days after pre-approval)
          const preApprovalDate = '{{ ad.pre_approval_date }}';
          if (preApprovalDate && preApprovalDate !== 'None') {
            const date = new Date(preApprovalDate);
            date.setDate(date.getDate() + 8);
            
            // Format English date as "30 August, 2025"
            const englishOptions = { year: 'numeric', month: 'long', day: 'numeric' };
            const englishDate = date.toLocaleDateString('en-US', englishOptions);
            
            // Convert to Nepali date
            const nepaliDate = gregorianToNepali(date);
            const nepaliDateString = `${nepaliDate.year}/${nepaliDate.month}/${nepaliDate.day}`;
            
            document.getElementById('calculated-interview-date').textContent = nepaliDateString;
            document.getElementById('calculated-interview-date-english').textContent = englishDate;
          } else {
            document.getElementById('calculated-interview-date').textContent = 'निर्धारण गर्नुहोस्';
            document.getElementById('calculated-interview-date-english').textContent = 'निर्धारण गर्नुहोस्';
          }
        </script>
      {% else %}
        अन्तरवार्ता मिति निर्धारण गर्नुहोस्।
      {% endif %}
  </div>
  
  <!-- Extra Information Section -->
  <div class="extra-section">
    <table class="extra-table">
      <thead>
        <tr>
          <th>स्वदेशमा गरिने मेडिकल खर्च कसले व्यहोर्ने </th>
          <th>विदेशमा गरिने मेडिकल खर्च कसले व्यहोर्ने</th>
          <th>स्वदेशमा गरिने म्यादी जीवन बिमा खर्च कसले व्यहोर्ने</th>
          <th class="col-insurance">रोजगारमा बिमा शुल्क हुने/नहुने<br>र प्रिमियम कसले व्यहोर्ने</th>
          <th>कामदारलाई हवाई टिकट कसले दिने र कति लाग्ने</th>
          <th>सामाजिक सुरक्षा कोष </th>
          <th>भिसा शुल्क कसले व्यहोर्ने</th>
          <th>भिसा स्ट्याम्प शुल्क कसले व्यहोर्ने</th>
          <th>अभिकृतिकरण शुल्क कति लाग्ने र कसले व्यहोर्ने</th>
          <th>कल्याणकारी कोष सम्बन्धी व्यवस्था</th>
          <th class="col-service-fee">सेवा शुल्क</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>{% if ad.medical_cost_local %}{{ ad.medical_cost_local }}{% else %}कुनै जानकारी{% endif %}</td>
          <td>{% if ad.medical_cost_foreign %}{{ ad.medical_cost_foreign }}{% else %}कुनै जानकारी{% endif %}</td>
          <td>{% if ad.insurance_local %}{{ ad.insurance_local }}{% else %}कुनै जानकारी{% endif %}</td>
          <td>{% if ad.insurance_employment %}{{ ad.insurance_employment }}{% else %}कुनै जानकारी{% endif %}</td>
          <td>{% if ad.air_ticket %}{{ ad.air_ticket }}{% else %}कुनै जानकारी{% endif %}</td>
          <td>{% if ad.visa_fee %}{{ ad.visa_fee }}{% else %}कुनै जानकारी{% endif %}</td>
          <td>{% if ad.visa_stamp_fee %}{{ ad.visa_stamp_fee }}{% else %}कुनै जानकारी{% endif %}</td>
          <td>{% if ad.recruitment_fee %}{{ ad.recruitment_fee }}{% else %}कुनै जानकारी{% endif %}</td>
          <td>{% if ad.welfare_fund %}{{ ad.welfare_fund }}{% else %}कुनै जानकारी{% endif %}</td>
          <td>{% if ad.labor_fee %}{{ ad.labor_fee }}{% else %}कुनै जानकारी{% endif %}</td>
          <td class="col-service-fee">{% if ad.service_fee %}{{ ad.service_fee }}{% else %}कुनै जानकारी{% endif %}</td>
        </tr>
      </tbody>
    </table>
    
    <!-- Condensed Notice Text -->
    <div class="extra-note">
      {% if ad.extra_notes %}
        <!-- Manual notice from user -->
        {{ ad.extra_notes|safe }}
      {% else %}
        <!-- Country-specific automatic notice -->
        {% if country_notice %}
          <div class="notice-content" id="notice-content">
            {{ country_notice.content|safe }}
          </div>
        {% else %}
          <!-- Default Japan content format -->
          <p><b>प्रशिक्षार्थीको आवश्यकता न्यूनतम योग्यता र काम गरेको अनुभव:</b> (क) नेपाली नागरिक हुनुपर्ने । (ख) प्रशिक्षणको उमेर १८ वर्ष पूरा भई २६ वर्ष ननाघेको हुनुपर्ने । (ग) प्रशिक्षार्थी नेपाल सरकारको उद्योग मन्त्रालय अन्तर्गतको निकायहरू वा यस पूर्व वा अहिले सञ्चालन भइसकेका उद्योग व्यवसाय, कलकारखाना, ढुंढी सहकारी, साना/कुटिर उद्योग, होटल पर्यटन व्यवसाय तथा अन्य व्यवसाय क्षेत्रमा काम गरेको अनुभव भएको हुनुपर्ने । (घ) निर्माण क्षेत्रमा काम गर्ने निर्माण सम्बन्धी उद्योग वा सम्बन्धित विषयका संस्थामा कम्तिमा दुई वर्ष काम गरेको अनुभव हुनुपर्ने । (ङ) प्रशिक्षणको विषय अनुसार काम गरेको अनुभव भएको र नेपालकै उद्योग प्रतिष्ठान, संस्था वा निकायहरूमा काम गरेको अनुभव हुनुपर्ने । (च) जापानी भाषा तथा संस्कृतिको सामान्य ज्ञान भएको हुनुपर्ने ।</p>

          <p><b>दरखास्त साथ पेश गर्ने आवश्यक कागजातहरू:</b> (क) नेपाली नागरिकताको प्रमाणपत्रको प्रमाणित प्रतिलिपि । (ख) शैक्षिक प्रमाणपत्रको प्रमाणित प्रतिलिपि । (ग) प्रशिक्षार्थी नेपाल सरकारको उद्योग मन्त्रालय अन्तर्गतको निकायहरू वा यस पूर्व भइसकेका उद्योग व्यवसाय, कलकारखाना, ढुंढी सहकारी, साना/कुटिर उद्योगसंस्था, होटल पर्यटन व्यवसाय तथा अन्य व्यवसाय क्षेत्रमा कम्तिमा २ वर्ष काम गरेको अनुभव सम्बन्धी प्रमाणपत्रको प्रमाणित प्रतिलिपि । (घ) सम्बन्धित विषयमा प्रशिक्षण प्राप्त गरेको प्रमाणपत्रको प्रमाणित प्रतिलिपि । (ङ) प्रशिक्षणको विषयमा कामदारको रुपमा जान खोजेको विषयमा नेपालका उद्योग प्रतिष्ठान, संस्था वा निकायहरूमा काम गरेको अनुभव प्रमाणपत्रको प्रमाणित प्रतिलिपि । (च) प्रशिक्षणको विषय अनुसार जापानी भाषा तथा संस्कृतिको सम्बन्धमा तालिम लिएको हुनुपर्ने प्रमाणपत्रको प्रमाणित प्रतिलिपि । (छ) अनुभवीहरूको लागि प्रशिक्षणको विषय अनुसार नेपालमै काम गरिरहेको उद्योग प्रतिष्ठान, निकाय वा संस्थाको सिफारिस र नेपाल फर्किएपछि पनि सोही कार्यक्षेत्र वा निकाय समक्ष काम गर्ने प्रतिवद्धतासहितको प्रमाणित कागजात पेश गर्नु पर्ने ।</p>

          <p><b>१) दरखास्त दाखिला गर्ने स्थान र मिति:</b> यस संस्थाको कार्यालयमा यो सूचना प्रकाशित भएको मितिले १५ दिन भित्र ।</p>

          <p><b>२) परीक्षाशुल्क:</b> निर्धारित बैंक खाता नम्बरमा जम्मा गर्नुपर्नेछ । परीक्षाशुल्क रकम रू. ५०००।–</p>

          <p><b>३) लिखित परीक्षा:</b> २०७८ साल माघ ३१ गते बिहान १०:०० बजे अनलाइन आप्रवासी कार्यालयमा आयोजित हुनेछ । परीक्षा दिन आउने परीक्षार्थीले आफ्नो नागरिकता प्रमाणपत्रको प्रतिलिपि ल्याउनुपर्नेछ ।</p>

          <p><b>वैदेशिक रोजगार विभागद्वारा जारी गरिएको जानकारी:</b><br>
          १. आफ्नो नाममा निष्काशन भई जारी गरिएको पासपोर्टमा कुनै त्रुटि भएमा तुरुन्तै सच्याउनुहोस् ।<br>
          २. आफ्नो दस्तावेज र काममा प्रयोग हुने कागजात सुरक्षित राख्नुहोस् ।<br>
          ३. यस विज्ञापन सम्बन्धमा उल्झन भएमा विभागले कुनै जिम्मेवारी लिने छैन ।<br>
          ४. विदेश जानु अघि अभिमुखीकरण तालिम लिनु पर्नेछ ।<br>
          ५. विदेश जानु अघि श्रम सम्झौता अनिवार्य रुपमा गर्नुपर्नेछ ।<br>
          ६. विदेश जानु अघि बीमा कम्पनीमा बीमा गर्नुपर्नेछ ।<br>
          ७. विदेश जानु अघि कुनै दलाल वा एजेन्टलाई पैसा दिनु हुने छैन ।<br>
          ८. पासपोर्ट, श्रम अनुमति, करारपत्र, टिकट आफैंले बुझी लिनुहोस् ।<br>
          ९. सीधै विमानस्थलमा जानुहोस् ।<br>
          १०. पासपोर्टमा समस्या भएमा विभागमा सम्पर्क गर्नुहोस् ।</p>

          <p><b>नोट:</b> जापानी भाषा N4 स्तरको ज्ञान भएकोलाई प्राथमिकता दिइनेछ ।</p>
        {% endif %}
      {% endif %}
    </div>
    </div>
  </div>
  
  <!-- Company Banner - ATTACHED -->
  <div class="company-banner">
    {% if ad.company_banner_image %}
      <!-- Display uploaded banner image -->
      <div class="banner-image-container" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
        {% if pdf_mode %}
          <img src="data:image/jpeg;base64,{{ ad.company_banner_image_base64 }}" alt="Company Banner" style="max-width: 100%; max-height: 100%; object-fit: contain;">
        {% else %}
          <img src="{{ ad.company_banner_image.url }}" alt="Company Banner" style="max-width: 100%; max-height: 100%; object-fit: contain;">
        {% endif %}
      </div>
    {% else %}
      <!-- Manual entry or default banner layout with company info -->
      <div class="company-logo">
        {% if ad.company_logo_image %}
          {% if pdf_mode %}
            <img src="data:image/jpeg;base64,{{ ad.company_logo_image_base64 }}" alt="Company Logo" style="max-width: 100%; max-height: 100%; object-fit: contain;">
          {% else %}
            <img src="{{ ad.company_logo_image.url }}" alt="Company Logo" style="max-width: 100%; max-height: 100%; object-fit: contain;">
          {% endif %}
        {% else %}
          <div>{{ ad.company_logo_text|default:"LOGO" }}</div>
        {% endif %}
      </div>
      
      <div class="company-info">
        <h1>{% if ad.company_banner_title %}{{ ad.company_banner_title }}{% else %}कुनै कम्पनी{% endif %}</h1>
        <p>
          {% if ad.company_address %}{{ ad.company_address }}{% else %}कुनै ठेगाना{% endif %} • {% if ad.company_phone %}{{ ad.company_phone }}{% else %}कुनै फोन{% endif %}<br>
          {% if ad.company_email %}{{ ad.company_email }}{% else %}कुनै इमेल{% endif %} • {% if ad.company_website %}{{ ad.company_website }}{% else %}कुनै वेब{% endif %}
        </p>
      </div>
      
      <div class="license-box">
        {% if ad.license_number %}{{ ad.license_number }}{% else %}कुनै लाइसेन्स{% endif %}
      </div>
    {% endif %}
  </div>
</div>

</body>
</html>