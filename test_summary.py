from transformers import AutoTokenizer, AutoModelForSeq2SeqLM
import torch

model_name = "csebuetnlp/mT5_multilingual_XLSum"

# Use slow tokenizer (stable) and load model
tok = AutoTokenizer.from_pretrained(model_name, use_fast=False)
mdl = AutoModelForSeq2SeqLM.from_pretrained(model_name)

# Use Apple Silicon GPU if available, else CPU
device = "mps" if torch.backends.mps.is_available() else "cpu"
mdl.to(device)

def summarize_ne(text, max_len=120, min_len=30):
    # For long news, set a tokenizer max_length to avoid memory issues
    enc = tok([text], return_tensors="pt", truncation=True, max_length=1024, padding="longest")
    enc = {k: v.to(device) for k, v in enc.items()}
    out_ids = mdl.generate(
        enc["input_ids"],
        max_length=max_len,        # summary length cap (increase to 150–180 if you want longer)
        min_length=min_len,        # ensure it’s not too short
        num_beams=4,
        length_penalty=2.0,
        early_stopping=True
    )
    return tok.decode(out_ids[0], skip_special_tokens=True)

# === test input (your full article) ===
text = """
काठमाडौं — नेपालको राजनीतिक परिदृश्य फेरि एक पटक निर्णायक मोडमा पुगेको छ। आगामी साधारण निर्वाचन नजिकिँदै गर्दा प्रमुख दलहरूले आफ्ना घोषणापत्र सार्वजनिक गर्न थालेका छन्। सत्तारुढ दलले स्थिरता र विकासलाई मुख्य एजेन्डा बनाएको छ भने प्रतिपक्षी दलहरूले सुशासन, भ्रष्टाचार नियन्त्रण र रोजगारी सिर्जनामा जोड दिएका छन्। घोषणापत्र सार्वजनिक कार्यक्रममा नेताहरूले आगामी पाँच वर्षभित्र देशलाई आर्थिक समृद्धिको बाटोमा अग्रसर बनाउने दाबी गरेका छन्। तर, नागरिक समाज र विश्लेषकहरूले भने यी घोषणाहरू कार्यान्वयन हुने वा नहुने भन्नेमा शंका प्रकट गरेका छन्। उनीहरूको भनाइमा अघिल्ला चुनावमा पनि यस्तै महत्वाकांक्षी घोषणा गरिएका थिए तर त्यसको ठोस कार्यान्वयन भएन।

त्यस्तै, निर्वाचन आयोगले पनि तयारीलाई तीव्र पारेको छ। आयोगले भौतिक पूर्वाधारदेखि लिएर प्राविधिक तयारीसम्मका सबै कामलाई अन्तिम रूप दिन लागेको छ। यस पटकको निर्वाचनमा प्राविधिक प्रणालीलाई अझ बलियो बनाउन इलेक्ट्रोनिक मतदाता दर्ता प्रणाली र पारदर्शिता सुनिश्चित गर्ने डिजिटल अनुगमन प्रणाली प्रयोग गरिने भएको छ। आयोगले मतदाता शिक्षा अभियान पनि सुरु गरेको छ, जसमा ग्रामीण भेगसम्म स्वयंसेवक खटाइनेछन्। यस अभियानमार्फत मतदातालाई सही तरिकाले मतदान गर्ने, उम्मेदवारको पृष्ठभूमि बुझ्ने र स्वतन्त्र रूपमा निर्णय गर्ने प्रोत्साहन दिइनेछ।

अर्कोतर्फ, चुनाव नजिकिँदै गर्दा सुरक्षा निकायहरूले पनि उच्च सतर्कता अपनाएका छन्। विशेष गरी संवेदनशील क्षेत्रहरूमा थप सुरक्षाकर्मी परिचालन गर्ने निर्णय गरिएको छ। प्रहरीले अवैध गतिविधि र पैसाको दुरुपयोग रोक्न निगरानी बढाएको छ भने सशस्त्र प्रहरी र सेनाले सीमा क्षेत्रमा सुरक्षा कडा पार्ने तयारी गरेका छन्। यस पटकको निर्वाचनमा विदेशी पर्यवेक्षकहरूलाई समेत आमन्त्रण गरिने भएको छ, जसले निर्वाचन प्रक्रियाको निष्पक्षता र पारदर्शितामा योगदान पुर्‍याउने अपेक्षा गरिएको छ।

यस्तै, विभिन्न गैर–सरकारी संस्था र नागरिक समूहहरूले समेत निर्वाचनलाई शान्तिपूर्ण, निष्पक्ष र सहभागीमूलक बनाउन आह्वान गरेका छन्। उनीहरूले दलहरूलाई वैचारिक बहसमा जोड दिन आग्रह गरेका छन्, ताकि जनताले वास्तविक विकल्पको आधारमा निर्णय गर्न सकून्। विश्लेषकहरूको भनाइमा, आगामी निर्वाचनले नेपालको लोकतान्त्रिक यात्रामा अर्को महत्वपूर्ण अध्याय थप्नेछ। तर यसले देशलाई राजनीतिक स्थिरता र आर्थिक प्रगतिमा कति योगदान पुर्‍याउने भन्ने प्रश्न भने अझै खुला छ।


"""

print("Original (first 400 chars):", text[:400], "...")
print("AI Summary:", summarize_ne(text))
